"""
メタファー辞書 - 日干×月支の120通り
"""

# 五行の意味辞書
GOGYO_MEANINGS = {
    "甲": ("木性", "春の木、成長力、創造性、拡大"),
    "乙": ("木性", "草花、柔軟性、適応力、調和"),
    "丙": ("火性", "太陽、情熱、表現力、リーダーシップ"),
    "丁": ("火性", "灯火、洞察力、精神性、芸術性"),
    "戊": ("土性", "山、安定、信頼、包容力"),
    "己": ("土性", "田畑、育成力、実務能力、調整力"),
    "庚": ("金性", "鉱石、意志力、決断力、正義感"),
    "辛": ("金性", "宝石、繊細さ、美的感覚、完璧主義"),
    "壬": ("水性", "大河、知性、自由、流動性"),
    "癸": ("水性", "雨露、思慮深さ、内省、神秘性"),
}

# メタファー辞書（日干×月支の120通り）
METAPHOR_DICT = {
    # 甲（春の木）
    "甲-子": {"本質": "厳冬の中で春を待つ種", "強み": "忍耐力、計画性", "課題": "実行までに時間がかかる", "アドバイス": "焦らず準備を"},
    "甲-丑": {"本質": "冬の土に眠る種", "強み": "蓄積力、持続力", "課題": "変化を嫌う", "アドバイス": "柔軟性を持つ"},
    "甲-寅": {"本質": "春の木々が芽吹く", "強み": "成長力、行動力", "課題": "暴走しやすい", "アドバイス": "方向性を定める"},
    "甲-卯": {"本質": "春爛漫の花園", "強み": "魅力、人気", "課題": "調子に乗りやすい", "アドバイス": "謙虚さを忘れずに"},
    "甲-辰": {"本質": "春の雨に育つ木", "強み": "適応力、発展性", "課題": "流されやすい", "アドバイス": "軸を持つ"},
    "甲-巳": {"本質": "初夏の太陽を浴びる木", "強み": "華やかさ、表現力", "課題": "燃え尽きやすい", "アドバイス": "休息を取る"},
    "甲-午": {"本質": "真夏の太陽と木", "強み": "エネルギー、情熱", "課題": "消耗が激しい", "アドバイス": "水分補給（休息）を"},
    "甲-未": {"本質": "夏の終わりの木", "強み": "成熟、安定", "課題": "保守的", "アドバイス": "新しい挑戦を"},
    "甲-申": {"本質": "秋の実りを待つ木", "強み": "計画性、戦略", "課題": "結果を急ぐ", "アドバイス": "プロセスを楽しむ"},
    "甲-酉": {"本質": "秋の木と金", "強み": "決断力、実行力", "課題": "傷つきやすい", "アドバイス": "柔軟性を持つ"},
    "甲-戌": {"本質": "晩秋の木", "強み": "堅実、忍耐", "課題": "頑固", "アドバイス": "他者の意見を聞く"},
    "甲-亥": {"本質": "冬の始まりの木", "強み": "準備力、計画性", "課題": "行動が遅い", "アドバイス": "小さく始める"},
    
    # 乙（草花）
    "乙-子": {"本質": "冬の草花", "強み": "粘り強さ、柔軟性", "課題": "目立たない", "アドバイス": "自己主張を"},
    "乙-丑": {"本質": "冬の土の中の根", "強み": "基礎固め、地道さ", "課題": "地味", "アドバイス": "華やかさも時には必要"},
    "乙-寅": {"本質": "春の草花", "強み": "成長力、適応力", "課題": "周りに流される", "アドバイス": "自分の道を"},
    "乙-卯": {"本質": "春の花畑", "強み": "魅力、調和", "課題": "優柔不断", "アドバイス": "決断力を持つ"},
    "乙-辰": {"本質": "春雨に濡れる草花", "強み": "しなやかさ、適応力", "課題": "方向性がぶれる", "アドバイス": "軸を持つ"},
    "乙-巳": {"本質": "初夏の花", "強み": "華やかさ、魅力", "課題": "短命", "アドバイス": "長期的視点を"},
    "乙-午": {"本質": "真夏の花", "強み": "情熱、表現力", "課題": "枯れやすい", "アドバイス": "休息を大切に"},
    "乙-未": {"本質": "夏の終わりの花", "強み": "成熟、落ち着き", "課題": "保守的", "アドバイス": "新しい挑戦を"},
    "乙-申": {"本質": "秋の草花", "強み": "実務能力、調整力", "課題": "傷つきやすい", "アドバイス": "自信を持つ"},
    "乙-酉": {"本質": "秋の花と金", "強み": "美的感覚、繊細さ", "課題": "傷つきやすい", "アドバイス": "強さも必要"},
    "乙-戌": {"本質": "晩秋の花", "強み": "忍耐力、粘り強さ", "課題": "地味", "アドバイス": "華やかさも時には"},
    "乙-亥": {"本質": "冬の始まりの花", "強み": "準備力、計画性", "課題": "行動が遅い", "アドバイス": "小さく始める"},
    
    # 丙（太陽）
    "丙-子": {"本質": "冬の太陽", "強み": "温かさ、希望", "課題": "力不足", "アドバイス": "仲間と協力"},
    "丙-丑": {"本質": "冬の朝日", "強み": "安定、持続", "課題": "派手さ不足", "アドバイス": "自己表現を"},
    "丙-寅": {"本質": "春の太陽", "強み": "成長力、活力", "課題": "暴走", "アドバイス": "冷静さを"},
    "丙-卯": {"本質": "春の陽気", "強み": "明るさ、魅力", "課題": "軽率", "アドバイス": "慎重さも"},
    "丙-辰": {"本質": "春の朝日", "強み": "希望、発展", "課題": "不安定", "アドバイス": "基盤を固める"},
    "丙-巳": {"本質": "初夏の太陽", "強み": "エネルギー、情熱", "課題": "燃え尽き", "アドバイス": "休息を"},
    "丙-午": {"本質": "真夏の太陽", "強み": "最強の輝き", "課題": "燃え尽き、孤独", "アドバイス": "周りを照らす"},
    "丙-未": {"本質": "夏の夕陽", "強み": "成熟、落ち着き", "課題": "衰退", "アドバイス": "新たな目標を"},
    "丙-申": {"本質": "秋の太陽", "強み": "実りの光", "課題": "力が弱まる", "アドバイス": "効率を上げる"},
    "丙-酉": {"本質": "秋の夕陽", "強み": "美しさ、余韻", "課題": "寂しさ", "アドバイス": "新しいつながりを"},
    "丙-戌": {"本質": "晩秋の太陽", "強み": "温かさ、包容力", "課題": "力不足", "アドバイス": "仲間と協力"},
    "丙-亥": {"本質": "冬の始まりの太陽", "強み": "希望の光", "課題": "弱い", "アドバイス": "休息して力を蓄える"},
    
    # 丁（灯火）
    "丁-子": {"本質": "冬の夜の灯火", "強み": "洞察力、温かさ", "課題": "消えやすい", "アドバイス": "自分を大切に"},
    "丁-丑": {"本質": "冬の炉火", "強み": "持続力、安定", "課題": "地味", "アドバイス": "自己表現を"},
    "丁-寅": {"本質": "春の灯火", "強み": "希望、洞察", "課題": "不安定", "アドバイス": "基盤を固める"},
    "丁-卯": {"本質": "春の夜桜", "強み": "美的感覚、魅力", "課題": "短命", "アドバイス": "長期的視点を"},
    "丁-辰": {"本質": "春雨の灯", "強み": "しなやかさ、適応力", "課題": "消えやすい", "アドバイス": "自分を守る"},
    "丁-巳": {"本質": "初夏の灯火", "強み": "情熱、芸術性", "課題": "燃え尽き", "アドバイス": "休息を"},
    "丁-午": {"本質": "真夏の灯火", "強み": "強い輝き", "課題": "消耗激しい", "アドバイス": "ペース配分を"},
    "丁-未": {"本質": "夏の夕暮れの灯", "強み": "落ち着き、深み", "課題": "寂しさ", "アドバイス": "つながりを大切に"},
    "丁-申": {"本質": "秋の灯火", "強み": "洞察力、知性", "課題": "孤独", "アドバイス": "仲間を"},
    "丁-酉": {"本質": "秋の夜の灯", "強み": "美的感覚、繊細さ", "課題": "傷つきやすい", "アドバイス": "強さも必要"},
    "丁-戌": {"本質": "晩秋の灯火", "強み": "温かさ、包容力", "課題": "消えやすい", "アドバイス": "自分を大切に"},
    "丁-亥": {"本質": "冬の始まりの灯", "強み": "希望、温もり", "課題": "弱い", "アドバイス": "休息を"},
    
    # 戊（山）
    "戊-子": {"本質": "冬の雪山", "強み": "不動、威厳", "課題": "冷たい", "アドバイス": "温かさを"},
    "戊-丑": {"本質": "冬の大地", "強み": "安定、信頼", "課題": "動かない", "アドバイス": "柔軟性を"},
    "戊-寅": {"本質": "春の山", "強み": "成長、発展", "課題": "崩れやすい", "アドバイス": "基盤固めを"},
    "戊-卯": {"本質": "春の花山", "強み": "魅力、包容力", "課題": "優柔不断", "アドバイス": "決断力を"},
    "戊-辰": {"本質": "春の山と雲", "強み": "雄大、包容力", "課題": "不安定", "アドバイス": "地に足をつける"},
    "戊-巳": {"本質": "初夏の山", "強み": "安定、温かさ", "課題": "動きが鈍い", "アドバイス": "行動を"},
    "戊-午": {"本質": "真夏の山", "強み": "堂々、威厳", "課題": "乾燥", "アドバイス": "柔軟性を"},
    "戊-未": {"本質": "夏の終わりの山", "強み": "安定、成熟", "課題": "保守的", "アドバイス": "新しい挑戦を"},
    "戊-申": {"本質": "秋の山", "強み": "実り、豊かさ", "課題": "動かない", "アドバイス": "行動を"},
    "戊-酉": {"本質": "秋の山と金", "強み": "豊かさ、安定", "課題": "頑固", "アドバイス": "柔軟性を"},
    "戊-戌": {"本質": "晩秋の山", "強み": "不動、信頼", "課題": "孤独", "アドバイス": "つながりを"},
    "戊-亥": {"本質": "冬の始まりの山", "強み": "威厳、包容力", "課題": "冷たい", "アドバイス": "温かさを"},
    
    # 己（田畑）
    "己-子": {"本質": "冬の田畑", "強み": "準備、計画", "課題": "実りなし", "アドバイス": "春を待つ"},
    "己-丑": {"本質": "冬の大地", "強み": "蓄積、持続", "課題": "地味", "アドバイス": "自己表現を"},
    "己-寅": {"本質": "春の田畑", "強み": "成長、育成", "課題": "荒れやすい", "アドバイス": "丁寧に"},
    "己-卯": {"本質": "春の花畑", "強み": "魅力、調和", "課題": "流されやすい", "アドバイス": "軸を持つ"},
    "己-辰": {"本質": "春雨の田畑", "強み": "育成力、適応力", "課題": "不安定", "アドバイス": "基盤を"},
    "己-巳": {"本質": "初夏の田畑", "強み": "成長、活力", "課題": "乾燥", "アドバイス": "休息を"},
    "己-午": {"本質": "真夏の田畑", "強み": "実り、豊かさ", "課題": "乾燥、疲弊", "アドバイス": "水分補給を"},
    "己-未": {"本質": "夏の終わりの田畑", "強み": "成熟、安定", "課題": "保守的", "アドバイス": "新しい種を"},
    "己-申": {"本質": "秋の田畑", "強み": "実り、収穫", "課題": "終わり", "アドバイス": "次の準備を"},
    "己-酉": {"本質": "秋の収穫", "強み": "豊かさ、実務能力", "課題": "終わり", "アドバイス": "新しい目標を"},
    "己-戌": {"本質": "晩秋の田畑", "強み": "蓄積、準備", "課題": "寂しさ", "アドバイス": "つながりを"},
    "己-亥": {"本質": "冬の始まりの田畑", "強み": "計画、準備", "課題": "寒い", "アドバイス": "温かさを"},
    
    # 庚（鉱石）
    "庚-子": {"本質": "冬の刀", "強み": "鋭さ、決断力", "課題": "冷たい", "アドバイス": "温かさを"},
    "庚-丑": {"本質": "冬の金属", "強み": "強さ、不屈", "課題": "硬い", "アドバイス": "柔軟性を"},
    "庚-寅": {"本質": "春の刀", "強み": "決断力、行動力", "課題": "暴走", "アドバイス": "慎重に"},
    "庚-卯": {"本質": "春の金と花", "強み": "美しさ、魅力", "課題": "傷つける", "アドバイス": "優しさを"},
    "庚-辰": {"本質": "春の金と土", "強み": "安定、強さ", "課題": "錆びる", "アドバイス": "磨き続ける"},
    "庚-巳": {"本質": "初夏の刀", "強み": "鋭さ、熱さ", "課題": "溶ける", "アドバイス": "冷静さを"},
    "庚-午": {"本質": "真夏の金属", "強み": "強烈な輝き", "課題": "溶ける", "アドバイス": "休息を"},
    "庚-未": {"本質": "夏の終わりの金", "強み": "成熟、落ち着き", "課題": "鈍る", "アドバイス": "磨き続ける"},
    "庚-申": {"本質": "秋の金", "強み": "最強の輝き", "課題": "孤独", "アドバイス": "仲間を"},
    "庚-酉": {"本質": "秋の金と金", "強み": "完璧、美しさ", "課題": "硬すぎ", "アドバイス": "柔軟性を"},
    "庚-戌": {"本質": "晩秋の金", "強み": "強さ、信頼", "課題": "錆びる", "アドバイス": "磨き続ける"},
    "庚-亥": {"本質": "冬の始まりの金", "強み": "鋭さ、決断", "課題": "冷たい", "アドバイス": "温かさを"},
    
    # 辛（宝石）
    "辛-子": {"本質": "冬の宝石", "強み": "美しさ、輝き", "課題": "冷たい", "アドバイス": "温かさを"},
    "辛-丑": {"本質": "冬の宝飾", "強み": "繊細さ、価値", "課題": "傷つきやすい", "アドバイス": "強さも"},
    "辛-寅": {"本質": "春の宝石", "強み": "美しさ、魅力", "課題": "傷つく", "アドバイス": "自分を守る"},
    "辛-卯": {"本質": "春の宝飾", "強み": "完璧な美", "課題": "繊細すぎ", "アドバイス": "強さを"},
    "辛-辰": {"本質": "春の宝と土", "強み": "価値、安定", "課題": "曇る", "アドバイス": "磨き続ける"},
    "辛-巳": {"本質": "初夏の宝石", "強み": "輝き、魅力", "課題": "溶ける", "アドバイス": "冷静さを"},
    "辛-午": {"本質": "真夏の宝石", "強み": "最高の輝き", "課題": "溶ける", "アドバイス": "休息を"},
    "辛-未": {"本質": "夏の終わりの宝", "強み": "成熟、落ち着き", "課題": "曇る", "アドバイス": "磨き続ける"},
    "辛-申": {"本質": "秋の宝石", "強み": "完璧、美しさ", "課題": "孤独", "アドバイス": "つながりを"},
    "辛-酉": {"本質": "秋の宝と金", "強み": "最高の輝き", "課題": "完璧主義", "アドバイス": "不完全も受け入れる"},
    "辛-戌": {"本質": "晩秋の宝石", "強み": "価値、信頼", "課題": "曇る", "アドバイス": "磨き続ける"},
    "辛-亥": {"本質": "冬の始まりの宝", "強み": "美しさ、輝き", "課題": "冷たい", "アドバイス": "温かさを"},
    
    # 壬（大河）
    "壬-子": {"本質": "冬の大河", "強み": "知性、深さ", "課題": "冷たい", "アドバイス": "温かさを"},
    "壬-丑": {"本質": "冬の川と土", "強み": "安定、持続", "課題": "流れが悪い", "アドバイス": "動きを"},
    "壬-寅": {"本質": "春の大河", "強み": "活力、流動性", "課題": "氾濫", "アドバイス": "制御を"},
    "壬-卯": {"本質": "春の川", "強み": "自由、流れ", "課題": "不安定", "アドバイス": "方向性を"},
    "壬-辰": {"本質": "春の川と雲", "強み": "自由、発展", "課題": "方向性不明", "アドバイス": "目標を持つ"},
    "壬-巳": {"本質": "初夏の川", "強み": "活発、流動", "課題": "干上がる", "アドバイス": "休息を"},
    "壬-午": {"本質": "真夏の川", "強み": "エネルギー、活力", "課題": "干上がる", "アドバイス": "補給を"},
    "壬-未": {"本質": "夏の終わりの川", "強み": "落ち着き、深さ", "課題": "流れが悪い", "アドバイス": "動きを"},
    "壬-申": {"本質": "秋の川", "強み": "知性、流動", "課題": "冷たい", "アドバイス": "温かさを"},
    "壬-酉": {"本質": "秋の川と金", "強み": "知性、美しさ", "課題": "冷たい", "アドバイス": "温かさを"},
    "壬-戌": {"本質": "晩秋の川", "強み": "深さ、包容力", "課題": "流れが悪い", "アドバイス": "動きを"},
    "壬-亥": {"本質": "冬の始まりの大河", "強み": "最強の流れ", "課題": "氾濫", "アドバイス": "制御を"},
    
    # 癸（雨露）
    "癸-子": {"本質": "冬の雨", "強み": "思慮深さ、内省", "課題": "寒い", "アドバイス": "温かさを"},
    "癸-丑": {"本質": "冬の霜", "強み": "持続、蓄積", "課題": "冷たい", "アドバイス": "温もりを"},
    "癸-寅": {"本質": "春の雨", "強み": "育成、潤い", "課題": "不安定", "アドバイス": "基盤を"},
    "癸-卯": {"本質": "春の露", "強み": "美しさ、繊細", "課題": "消えやすい", "アドバイス": "強さを"},
    "癸-辰": {"本質": "春雨", "強み": "育成力、柔軟性", "課題": "方向性不明", "アドバイス": "目標を"},
    "癸-巳": {"本質": "初夏の雨", "強み": "潤い、恵み", "課題": "蒸発", "アドバイス": "自分を大切に"},
    "癸-午": {"本質": "真夏の雨", "強み": "恵みの雨", "課題": "蒸発", "アドバイス": "自分を守る"},
    "癸-未": {"本質": "夏の終わりの雨", "強み": "しっとり、落ち着き", "課題": "消えやすい", "アドバイス": "存在感を"},
    "癸-申": {"本質": "秋の雨", "強み": "しっとり、情緒", "課題": "寂しい", "アドバイス": "つながりを"},
    "癸-酉": {"本質": "秋の露", "強み": "美しさ、繊細", "課題": "消えやすい", "アドバイス": "強さを"},
    "癸-戌": {"本質": "晩秋の雨", "強み": "思慮深さ、内省", "課題": "寂しい", "アドバイス": "つながりを"},
    "癸-亥": {"本質": "冬の始まりの雨", "強み": "深さ、神秘性", "課題": "冷たい", "アドバイス": "温かさを"},
}


def get_metaphor(day_kan: str, month_shi: str) -> dict:
    """日干と月支からメタファーを取得
    
    Args:
        day_kan: 日干（甲〜癸）
        month_shi: 月支（子〜亥）
    
    Returns:
        メタファー辞書 {"本質", "強み", "課題", "アドバイス"}
    """
    key = f"{day_kan}-{month_shi}"
    return METAPHOR_DICT.get(key, {
        "本質": "未知の組み合わせ",
        "強み": "独自性",
        "課題": "前例なし",
        "アドバイス": "自分の道を切り開く"
    })


def get_gogyo_meaning(kan: str) -> tuple:
    """十干から五行の意味を取得
    
    Args:
        kan: 十干（甲〜癸）
    
    Returns:
        (五行属性, 意味) のタプル
    """
    return GOGYO_MEANINGS.get(kan, ("不明", "不明"))
