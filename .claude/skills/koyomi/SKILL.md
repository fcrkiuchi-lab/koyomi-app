---
name: koyomi-interpretation
description: 四柱推命の計算結果（JSON形式）を受け取り、ユーザーに優しい日本語で解釈・説明する。時刻不明の場合は三柱推命モードで対応。
---

# 四柱推命 鑑定結果解釈スキル

## 目的
`meishiki.py` の出力（五行バランス、調候用神等）を受け取り、
ユーザーが理解しやすい形で鑑定結果を説明する。

---

## 入力形式

### 四柱推命（時刻あり）
```json
{
  "五行バランス": {
    "木": 2,
    "火": 1,
    "土": 3,
    "金": 1,
    "水": 1
  },
  "調候用神": "甲木生於春月、喜水潤土",
  "生年月日": "1990-05-15",
  "時刻": "14:30",
  "モード": "四柱推命"
}
```

### 三柱推命（時刻不明）
```json
{
  "五行バランス": {
    "木": 2,
    "火": 1,
    "土": 2,
    "金": 1,
    "水": 1
  },
  "調候用神": "甲木生於春月、喜水潤土",
  "生年月日": "1990-05-15",
  "時刻": null,
  "モード": "三柱推命"
}
```

---

## 出力形式

### 1. 結論（2-3文）
**最も重要なポイントを先に伝える**

- ポジティブな視点で表現
- 専門用語は使わない
- 具体的で実生活に活かせる内容

**良い例**：
```
あなたの命式は土のエネルギーが強く、安定感のある性質です。
水の要素を補うことで、さらにバランスが整います。
柔軟性と論理性を意識すると、持ち前の安定感が活きるでしょう。
```

**悪い例**：
```
土旺の命式です。水を用神とします。金水運が良いです。
```
（専門用語が多く、わかりにくい）

---

### 2. 詳細解説（階層構造）

#### A. 五行バランス
各要素の意味を現代的な表現で：

- **木（もく）**: 成長、上昇志向、創造性
  - 多い → 成長意欲が強い、変化を好む
  - 少ない → 安定志向、現状維持を好む

- **火（か）**: 情熱、華やかさ、表現力
  - 多い → エネルギッシュ、社交的
  - 少ない → 落ち着いている、内向的

- **土（ど）**: 安定、信頼、包容力
  - 多い → どっしり構える、頼られる
  - 少ない → 変化に柔軟、軽やか

- **金（きん）**: 鋭さ、論理性、決断力
  - 多い → 論理的、判断が速い
  - 少ない → 感情重視、柔軟な判断

- **水（すい）**: 柔軟性、知恵、適応力
  - 多い → 臨機応変、人間関係が得意
  - 少ない → 一貫性がある、信念を貫く

#### B. 調候用神の解説
専門用語を噛み砕いて説明：

**例**：「甲木生於春月、喜水潤土」
```
あなたは春生まれの木（甲木）です。
春の木は成長期にあり、水分（水）と栄養豊かな土が必要です。

実生活では：
- 新しい学びや経験（水）を積極的に取り入れる
- 信頼できる基盤（土）を大切にする

このバランスを意識することで、持ち前の成長力が発揮されます。
```

---

### 3. メタファー（選択肢から選ぶ）

#### パターンA：自然の風景
```
あなたの命式は、豊かな大地（土）に根を張る若木（木）のようです。
時折、静かな小川（水）が流れ、穏やかな日差し（火）が降り注ぎます。
```

#### パターンB：都市の比喩
```
安定した基盤（土）の上に建つビル（木）。
時に情熱（火）が灯り、冷静な判断（金）が働き、
柔軟な対応（水）も可能です。
```

#### パターンC：人間関係
```
包容力のある（土）性格で、成長意欲（木）も持ち合わせています。
情熱（火）を適度に保ち、論理性（金）と柔軟性（水）で
バランスを取ります。
```

**選定基準**：
- 五行バランスの特徴が表現されているか
- ユーザーがイメージしやすいか
- ポジティブな印象を与えるか

---

## 三柱推命モードの対応

時刻不明の場合、以下を冒頭に追加：

```
⏰ 時刻不明モードで鑑定しました。

出生時刻がわかると、より詳細な鑑定が可能です。
ただし、三柱推命でも十分に性質の傾向は読み取れます。
```

---

## 禁止事項

### ❌ 断定的な表現
```
悪い例：「あなたは必ず成功します」
良い例：「あなたには成功する素質があります」
```

### ❌ 依存を促す表現
```
悪い例：「この日以外は何もしてはいけません」
良い例：「この日は特に良い流れがありそうです。参考にしてみてください」
```

### ❌ ネガティブな断定
```
悪い例：「あなたには向いていません」
良い例：「別のアプローチも試してみる価値があります」
```

### ✅ 選択肢を示す
```
「〜という考え方もあります」
「〜も一つの選択肢です」
「〜を意識すると良いかもしれません」
```

---

## 実装例（Streamlit）

```python
import streamlit as st
import json

# 鑑定結果（meishiki.pyからの出力）
result = {
    "五行バランス": {"木": 2, "火": 1, "土": 3, "金": 1, "水": 1},
    "調候用神": "甲木生於春月、喜水潤土",
    "モード": "四柱推命"
}

# このスキルを適用（Claudeに渡す）
with st.chat_message("assistant"):
    st.markdown(f"""
### 🌸 あなたの命式

**安定感のある性質**です。  
水の要素を補うことで、さらにバランスが整います。
柔軟性と論理性を意識すると、持ち前の安定感が活きるでしょう。
    """)
    
    with st.expander("📊 五行バランスの詳細"):
        cols = st.columns(5)
        elements = ["木", "火", "土", "金", "水"]
        colors = ["🟢", "🔴", "🟤", "⚪", "🔵"]
        
        for i, elem in enumerate(elements):
            with cols[i]:
                st.metric(
                    label=f"{colors[i]} {elem}",
                    value=result["五行バランス"][elem]
                )
    
    with st.expander("🔍 調候用神の解説"):
        st.markdown("""
あなたは春生まれの木（甲木）です。
春の木は成長期にあり、水分（水）と栄養豊かな土が必要です。

**実生活では**：
- 新しい学びや経験（水）を積極的に取り入れる
- 信頼できる基盤（土）を大切にする
        """)
    
    with st.expander("💡 メタファー"):
        st.info("""
あなたの命式は、豊かな大地（土）に根を張る若木（木）のようです。
時折、静かな小川（水）が流れ、穏やかな日差し（火）が降り注ぎます。
        """)
```

---

## 哲学

**運命とは命の運び**

- 「決まっていること」を告げるのではない
- 「どう運ぶか」の選択肢を照らす
- 依存ではなく、自立のお手伝い

ユーザーが自分で考え、選択し、行動するための
**足元を照らすランタン**であれ。

---

## バージョン履歴

- v1.0 (2025-02-12): 初版作成
  - 基本的な解釈パターン定義
  - 三柱推命モード対応
  - メタファー3パターン実装
